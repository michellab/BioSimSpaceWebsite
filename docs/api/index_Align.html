

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>BioSimSpace.Align &mdash; BioSimSpace 2018.1.1+664.gb8eaf29 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BioSimSpace.FreeEnergy" href="index_FreeEnergy.html" />
    <link rel="prev" title="Documentation" href="index.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> BioSimSpace
          

          
            
            <img src="../_static/bss-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2018.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">BioSimSpace.Align</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index_FreeEnergy.html">BioSimSpace.FreeEnergy</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Gateway.html">BioSimSpace.Gateway</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_IO.html">BioSimSpace.IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_MD.html">BioSimSpace.MD</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Notebook.html">BioSimSpace.Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Parameters.html">BioSimSpace.Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Process.html">BioSimSpace.Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Protocol.html">BioSimSpace.Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Solvent.html">BioSimSpace.Solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Trajectory.html">BioSimSpace.Trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Types.html">BioSimSpace.Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Units.html">BioSimSpace.Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Exceptions.html">BioSimSpace._Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_SireWrappers.html">BioSimSpace._SireWrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_Utils.html">BioSimSpace._Utils</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../legal.html">Legal notices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BioSimSpace</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Documentation</a> &raquo;</li>
        
      <li>BioSimSpace.Align</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/index_Align.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="biosimspace-align">
<span id="ref-align"></span><h1>BioSimSpace.Align<a class="headerlink" href="#biosimspace-align" title="Permalink to this headline">¶</a></h1>
<p>The <em>Align</em> package contains tools to select features from MD-trajectories.
It also assigns them to a discrete state space, which will be later used in Markov
modeling.</p>
<p>It supports reading from MD-trajectories, comma separated value ASCII files and
NumPy arrays. The discretized trajectories are being stored as NumPy arrays of
integers.</p>
<span class="target" id="module-BioSimSpace.Align"></span><p>Functionality for aligning molecules.
Author: Lester Hedges &lt;<a class="reference external" href="mailto:lester&#46;hedges&#37;&#52;&#48;gmail&#46;com">lester<span>&#46;</span>hedges<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<dl class="function">
<dt id="BioSimSpace.Align.matchAtoms">
<code class="descclassname">BioSimSpace.Align.</code><code class="descname">matchAtoms</code><span class="sig-paren">(</span><em>molecule0</em>, <em>molecule1</em>, <em>scoring_function='RMSD align'</em>, <em>matches=1</em>, <em>return_scores=False</em>, <em>prematch={}</em>, <em>timeout=5.0000 secs</em>, <em>match_light=True</em>, <em>property_map0={}</em>, <em>property_map1={}</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#BioSimSpace.Align.matchAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Find mappings between atom indices in molecule0 to those in molecule1.
Molecules are aligned using a Maximum Common Substructure (MCS) search.
When requesting more than one match, the mappings will be sorted using
a scoring function and returned in order of best to worst score. (Note
that, depending on the scoring function the “best” score may have the
lowest value.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule0</strong> (<em>BioSimSpace._SireWrappers.Molecule</em>) – The molecule of interest.</li>
<li><strong>molecule1</strong> (<em>BioSimSpace._SireWrappers.Molecule</em>) – The reference molecule.</li>
<li><strong>scoring_function</strong> (<em>str</em>) – <dl class="docutils">
<dt>The scoring function used to match atoms. Available options are:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>”RMSD”</dt>
<dd>Calculate the root mean squared distance between the
coordinates of atoms in molecule0 to those that they
map to in molecule1.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>”RMSD align”</dt>
<dd>Align molecule0 to molecule1 based on the mapping before
computing the above RMSD score.</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><strong>matches</strong> (<em>int</em>) – The maximum number of matches to return. (Sorted in order of score).</li>
<li><strong>return_scores</strong> (<em>bool</em>) – Whether to return a list containing the scores for each mapping.</li>
<li><strong>prematch</strong> (<em>dict</em>) – A pre-match to use as the basis of the search.</li>
<li><strong>timeout</strong> (<em>BioSimSpace.Types.Time</em>) – The timeout for the matching algorithm.</li>
<li><strong>match_light</strong> (<em>bool</em>) – Whether to match light atoms.</li>
<li><strong>property_map0</strong> (<em>dict</em>) – A dictionary that maps “properties” in molecule0 to their user
defined values. This allows the user to refer to properties
with their own naming scheme, e.g. { “charge” : “my-charge” }</li>
<li><strong>property_map1</strong> (<em>dict</em>) – A dictionary that maps “properties” in molecule1 to their user
defined values.</li>
<li><strong>verbose</strong> (<em>bool</em>) – Whether to print status information from the matcher.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>matches</strong> – The best atom mapping, a list containing a user specified number of
the best mappings ranked by their score, or a tuple containing the
list of best mappings and a list of the corresponding scores.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict, [dict], ([dict], list)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="BioSimSpace.Align.merge">
<code class="descclassname">BioSimSpace.Align.</code><code class="descname">merge</code><span class="sig-paren">(</span><em>molecule0</em>, <em>molecule1</em>, <em>mapping=None</em>, <em>property_map0={}</em>, <em>property_map1={}</em><span class="sig-paren">)</span><a class="headerlink" href="#BioSimSpace.Align.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a merged molecule from ‘molecule0’ and ‘molecule1’ based on the
atom index ‘mapping’. The merged molecule can be used in single- and
dual-toplogy free energy calculations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule0</strong> (<em>BioSimSpace._SireWrappers.Molecule</em>) – A molecule object.</li>
<li><strong>molecule1</strong> (<em>BioSimSpace._SireWrappers.Molecule</em>) – A second molecule object.</li>
<li><strong>mapping</strong> (<em>dict</em>) – The mapping between matching atom indices in the two molecules.
If no mapping is provided, then atoms in molecule0 will be mapped
to those in molecule1 using “findMCSmatches”, with “rmsdAlign” then
used to align molecule0 to molecule1 based on the resulting mapping.</li>
<li><strong>property_map0</strong> (<em>dict</em>) – A dictionary that maps “properties” in molecule0 to their user
defined values. This allows the user to refer to properties
with their own naming scheme, e.g. { “charge” : “my-charge” }</li>
<li><strong>property_map1</strong> (<em>dict</em>) – A dictionary that maps “properties” in molecule1 to their user
defined values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>molecule</strong> – The merged molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">BioSimSpace._SireWrappers.Molecule</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="BioSimSpace.Align.rmsdAlign">
<code class="descclassname">BioSimSpace.Align.</code><code class="descname">rmsdAlign</code><span class="sig-paren">(</span><em>molecule0</em>, <em>molecule1</em>, <em>mapping=None</em>, <em>property_map0={}</em>, <em>property_map1={}</em><span class="sig-paren">)</span><a class="headerlink" href="#BioSimSpace.Align.rmsdAlign" title="Permalink to this definition">¶</a></dt>
<dd><p>Align atoms in molecule0 to those in molecule1 using the mapping
between matched atom indices. The molecule is aligned based on
a root mean squared displacement (RMSD) fit to find the optimal
translation vector (as opposed to merely taking the difference of
centroids).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule0</strong> (<em>BioSimSpace._SireWrappers.Molecule</em>) – The molecule to align.</li>
<li><strong>molecule1</strong> (<em>BioSimSpace._SireWrappers.Molecule</em>) – The reference molecule.</li>
<li><strong>mapping</strong> (<em>dict</em>) – A dictionary mapping atoms in molecule0 to those in molecule1.</li>
<li><strong>property_map0</strong> (<em>dict</em>) – A dictionary that maps “properties” in molecule0 to their user
defined values. This allows the user to refer to properties
with their own naming scheme, e.g. { “charge” : “my-charge” }</li>
<li><strong>property_map1</strong> (<em>dict</em>) – A dictionary that maps “properties” in molecule1 to their user
defined values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>molecule</strong> – The aligned molecule.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">BioSimSpace._SireWrappers.Molecule</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="index_FreeEnergy.html" class="btn btn-neutral float-right" title="BioSimSpace.FreeEnergy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2019 Michel Lab
      Last updated on Jan 30, 2019.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>